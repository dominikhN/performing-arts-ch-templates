<bs-col sm="4">

    <!-- official name -->
    <semantic-query 
        query='SELECT ?typelabel ?value
        WHERE {
            ?? crm:P131_is_identified_by ?app .
            ?app a crm:E82_Actor_Appellation ; 
            crm:P2_has_type spav:yanuj ;
            rdf:value ?value .
        } LIMIT 1'
    template='<p><strong>{{#each bindings}}{{value.value}}{{/each}}</strong></p>'>
    </semantic-query>

    <!-- alternative names -->
    <semantic-query 
        query='SELECT distinct ?appellation ?type ?typesort
        WHERE {
            VALUES (?type ?typesort) { (spav:yamqk 1) (spav:yavtx 2) }
            ?? crm:P131_is_identified_by ?appellation .
            ?appellation a crm:E82_Actor_Appellation ; 
                crm:P2_has_type ?type .
        } ORDER BY ?typesort'
        template='<p>{{#each bindings}}{{#if @first}}<mp-label iri="{{appellation.value}}"></mp-label> (<mp-label iri="{{type.value}}"></mp-label>)
            {{else}}<br><mp-label iri="{{appellation.value}}"></mp-label> (<mp-label iri="{{type.value}}"></mp-label>){{/if}}{{/each}}</p>'>
    </semantic-query>

    <!-- place -->
    <semantic-query 
        query="SELECT ?place
        WHERE {
            ?? crm:P74_has_current_or_former_residence ?p .
            ?p crm:P89_falls_within ?place .
        }"
        template='<p>{{#each bindings}}{{#if @first}}<semantic-link iri="{{place.value}}">{{label.value}}</semantic-link>{{else}}, <semantic-link iri="{{place.value}}">{{label.value}}</semantic-link>{{/if}}{{/each}}</p>'>
    </semantic-query>

    <!-- dates -->
    <semantic-query 
        query='SELECT ?dates
        WHERE {
            OPTIONAL {
                ?? crm:P95i_was_formed_by ?formation .
                ?formation a crm:E66_Formation ;
                    crm:P4_has_time-span ?formationtime .
                ?formationtime rdfs:label ?formationlabel .
            }
            OPTIONAL {
                ?? crm:P99i_was_dissolved_by ?dissolution .
                ?dissolution a crm:E68_Dissolution ;
                    crm:P4_has_time-span ?dissolutiontime .
                ?dissolutiontime rdfs:label ?dissolutionlabel .
            }
            BIND(CONCAT(COALESCE(?formationlabel, "X"), "-", COALESCE(?dissolutionlabel, "X")) AS ?predates)
            BIND(REPLACE(REPLACE(?predates, "X-X", ""), "X", "") AS ?dates)
        }'
        template='{{#each bindings}}<p>{{dates.value}}</p>{{/each}}'>
    </semantic-query>

    <mp-field-visualization
        subject='[[this]]'
        fields='[[fieldDefinitions
        predecessor="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupPredecessor"
        successor="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupSuccessor"
        controller="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupController"
        controlled="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupControlled"
        website="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/Website"
        ]]'
        template='{{> sapaModule:FieldBasedVisualizationList subject="[[this]]"}}' 
        [[!-- show in include [[> sapaModule:FieldBasedVisualizationList ]] --]]
        >
    </mp-field-visualization> 

</bs-col>

<bs-col sm="4">

    <!-- venues -->
    <semantic-query 
        query='SELECT ?label WHERE {
            VALUES (?label) { (<http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupVenue>) }
            ?? crm:P14i_performed ?activity .
            ?activity crm:P2_has_type spav:mujfv ;
                crm:P16_used_specific_object ?venue .
            } LIMIT 1'
        template='<h5>{{#each bindings}}<mp-label iri="{{label.value}}"></mp-label>{{/each}}</h5>'>
    </semantic-query>
    <semantic-tree
         query='SELECT DISTINCT ?node ?parent ?unidentified WHERE {
            ?? crm:P14i_performed ?activity .
            ?activity a crm:E7_Activity ;
                crm:P2_has_type spav:mujfv ;
                crm:P16_used_specific_object ?parent .
            ?parent crm:P46_is_composed_of* ?node .
            FILTER(ISIRI(?node))
            ?node rdfs:label ?label .
            BIND(IF(CONTAINS(STR($node), "/u/"), "true", "") AS ?unidentified)
          } ORDER BY ?label'
          tuple-template='{{#if data.unidentified.value}}
          <mp-label iri="{{data.node.value}}"></mp-label>{{else}}
          <semantic-link iri="{{data.node.value}}"></semantic-link>{{/if}}'> 
    </semantic-tree>

    <mp-field-visualization
        subject='[[this]]'
        fields='[[fieldDefinitions
        members="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupMember"
        association_members="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/AssociationMembers"
        associations="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/GroupAssociation"
        notes="http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/Note"
        ]]'
        template='{{> sapaModule:FieldBasedVisualizationList subject="[[this]]"}}' 
        [[!-- show in include [[> sapaModule:FieldBasedVisualizationList ]] --]]
    >
    </mp-field-visualization> 

    <!-- record sets -->
    <semantic-query 
        query='SELECT ?label WHERE {
            VALUES (?label) { (<http://performing-arts.ch/ldp-assets/fieldDefinitionContainer/SubjectOf>) }
            ?record rico:hasSubject ?? .
        } LIMIT 1'
        template='<h5>{{#each bindings}}<mp-label iri="{{label.value}}"></mp-label>{{/each}}</h5>'>
    </semantic-query>

    [[#if (hasPermission "forms:ldp:*")]]
    <semantic-tree
         query='SELECT DISTINCT ?node ?parent ?label ?description WHERE {
            ?record rico:hasSubject ?? ;
                rico:isPartOf* ?node .
            FILTER(ISIRI(?node))
            FILTER(CONTAINS(STR(?node), "/r/"))
            OPTIONAL { ?node rico:isPartOf ?parent. FILTER(ISIRI(?parent)) }
            ?node dc:title ?label .
            OPTIONAL { ?node dc:description ?description . }
          }'
          tuple-template='<span><semantic-link iri="{{data.node.value}}"></semantic-link><br>{{data.description.value}}</span>'> 
    </semantic-tree>
    [[else]]
    <semantic-query 
        query='SELECT ?record ?description WHERE {
            ?record rico:hasSubject ?? .
            OPTIONAL { ?record dc:description ?description . }
        }'
        template='<div>{{#each bindings}}<div><semantic-link iri="{{record.value}}"></semantic-link>{{#if description}}<br/>{{description.value}}{{/if}}{{/each}}</div>'>
    </semantic-query>
    <!-- Doesn't work with combined descriptions like "P, PA"
    <semantic-query 
        query='SELECT ?description ?vocab WHERE {
            ?? rdau:P60806 ?record .
            ?record dc:description ?description 
            VALUES ( ?description ?vocab ) {
                    ( "P" spav:dfblx )
                    ( "PA" spav:dffop )
                }
            }'
        template='<div>{{#each bindings}}<div><mp-label iri="{{vocab.value}}"></mp-label> / {{description.value}}</div>{{/each}}</div>'>
    </semantic-query> -->
    [[/if]]

</bs-col>

<bs-col sm="4">
    [[> sapaModule:ExternalResources]]
</bs-col>